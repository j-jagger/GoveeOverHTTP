<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <title id="title">GoveeOverHTTP</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark-subtle shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand">GoveeOverHTTP</a>
        </div>
    </nav>

    <main class="container my-5">
        <div class="row">
            <div class="col-md-8">
                <h1 class="mb-4">Welcome to GoveeOverHTTP!</h1>
                <p for="colorPicker">Set Colour</p>
                <input type="color" id="colorPicker">

                <p for="powerState" class="mt-4">Set Power</p>
                <input type="checkbox" id="powerState">
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Notice:</h5>
                        <p class="card-text">GOH is completely unfinished. You are running a Proof of Concept.

                            Also, try not to drag the colour thing too much or the Bluetooth Interface dies for a
                            moment.

                        </p>
                    </div>
                </div>
            </div>
        </div>


    </main>

    <script>
        const colorPicker = document.getElementById("colorPicker");
        const powerState = document.getElementById("powerState");

        const title = document.getElementById("title");
        title.innerText = `G.O.H. @ ${window.location.host}`

        function hexToRgb(hex) {
            hex = hex.replace(/^#/, "");
            let bigint = parseInt(hex, 16);
            let r = (bigint >> 16) & 255;
            let g = (bigint >> 8) & 255;
            let b = bigint & 255;
            return { r, g, b };
        }

        colorPicker.addEventListener("input", () => {
            const rgb = hexToRgb(colorPicker.value);
            const req = fetch(`/goh/api/set_colour?rgb=${rgb.r}-${rgb.g}-${rgb.b}`)

            console.log(`RGB: (${rgb.r}, ${rgb.g}, ${rgb.b})`);
        });

        powerState.addEventListener("input", () => {
            const state = powerState.checked;

            const req = fetch(`/goh/api/set_power?state=${String(state)}`);


        })
    </script>
</body>

</html>